name: Quant Explorer (Lv2)

on:
  schedule:
    # ğŸ§­ è‚¡æ± æ›´æ–°ï¼ˆæ¯å¤©ä¸€æ¬¡ï¼‰
    - cron: '30 00 * * *'   # UTC 00:30ï¼ˆå°ç£ 08:30ï¼‰

    # ğŸ” Explorer AIï¼ˆæ¯å¤©ä¸€æ¬¡ï¼‰
    - cron: '00 01 * * *'   # UTC 01:00ï¼ˆå°ç£ 09:00ï¼‰

  workflow_dispatch:

jobs:
  explorer:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
          cache: 'pip'

      - name: Install dependencies
        run: |
          cd repos/Stock-Genius-System
          pip install -r requirements.txt

      # ===============================
      # 1ï¸âƒ£ æ›´æ–° Explorer è‚¡æ± ï¼ˆåªå¯« JSONï¼‰
      # ===============================
      - name: Update TW Explorer Pool
        run: |
          cd repos/Stock-Genius-System
          python scripts/update_tw_explorer_pool.py

      - name: Update US Explorer Pool
        run: |
          cd repos/Stock-Genius-System
          python scripts/update_us_explorer_pool.py

      # ===============================
      # 2ï¸âƒ£ Explorer AIï¼ˆåªé¡¯ç¤º Top 5ï¼‰
      # ===============================
      - name: Run TW Explorer AI
        env:
          DISCORD_WEBHOOK_TW: ${{ secrets.DISCORD_WEBHOOK_TW }}
        run: |
          cd repos/Stock-Genius-System
          python scripts/ai_tw_explorer_post.py

      - name: Run US Explorer AI
        env:
          DISCORD_WEBHOOK_US: ${{ secrets.DISCORD_WEBHOOK_US }}
        run: |
          cd repos/Stock-Genius-System
          python scripts/ai_us_explorer_post.py
