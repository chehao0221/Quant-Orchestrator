name: Explorer System

on:
  workflow_dispatch:

  schedule:
    # ğŸ§­ Explorer ç›¤å¾Œï¼ˆå°ç£ 19:00ï¼‰
    - cron: "0 11 * * 1-5"

jobs:
  guardian-gate:
    runs-on: ubuntu-latest
    outputs:
      allowed: ${{ steps.gate.outputs.allowed }}
    steps:
      - uses: actions/checkout@v4
      - name: Guardian Pause Gate
        id: gate
        run: |
          python shared/check_guardian_gate.py

  explorer:
    needs: guardian-gate
    if: needs.guardian-gate.outputs.allowed == 'true'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.10"
      - run: pip install -r repos/Stock-Genius-System/requirements.txt
      - name: Update TW Explorer Pool
        run: python repos/Stock-Genius-System/scripts/update_tw_explorer_pool.py
      - name: Update US Explorer Pool
        run: python repos/Stock-Genius-System/scripts/update_us_explorer_pool.py
